<nav class="navbar-container">
  <div class="navbar-brand">
    <a [routerLink]="user ? '/client' : '/'">Barbería</a>
  </div>

  <!-- === CONTENIDO VISIBLE EN CABECERA MÓVIL === -->
  <div class="mobile-header-content">
    <!-- Caso Invitado: Botón pequeño de entrar -->
    <button *ngIf="!user" class="btn-login-mobile-header" (click)="handleLogin()">
      Iniciar Sesión
    </button>
    
    <!-- Caso Cliente: Saludo -->
    <span *ngIf="user?.role === 'CLIENT'" class="greeting-mobile-header">
      Hola, {{ user?.firstName }}
    </span>

    <!--Caso Barbero: Saludo-->
    <span *ngIf="user?.role === 'BARBER'" class="greeting-mobile-header">
      Hola, {{ user?.firstName }}
    </span>

    <!-- Caso Admin: Saludo cordial -->
    <span *ngIf="user?.role === 'ADMIN'" class="greeting-mobile-header">
      Bienvenido, Admin {{ user?.firstName }}
    </span>
  </div>

  <button class="navbar-toggle" (click)="toggleMenu()">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </button>

  <!-- MENÚ DESPLEGABLE -->
   
  <ul class="navbar-links" [class.is-open]="isMenuOpen">
    
    <!-- Enlaces Cliente -->
    <li *ngIf="user?.role !== 'ADMIN' && user?.role !== 'BARBER'">
      <a [routerLink]="user ? '/client' : '/'" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" (click)="isMenuOpen = false">Inicio</a>
    </li>
    <li *ngIf="user?.role !== 'ADMIN' && user?.role !== 'BARBER'">
      <a [routerLink]="user ? '/client' : '/'" fragment="seccion-servicios" (click)="isMenuOpen = false">Servicios</a>
    </li>
    <li *ngIf="user?.role !== 'ADMIN' && user?.role !== 'BARBER'">
      <a [routerLink]="user ? '/client' : '/'" fragment="seccion-barberos" (click)="isMenuOpen = false">Barberos</a>
    </li>
    <li *ngIf="user?.role !== 'ADMIN' && user?.role !== 'BARBER'">
      <a [routerLink]="user ? '/client' : '/'" fragment="seccion-contacto" (click)="isMenuOpen = false">Contacto</a>
    </li>

    <!-- Enlace Cliente -->
    <li *ngIf="user?.role === 'CLIENT'">
      <a routerLink="/client/reservations" routerLinkActive="active" (click)="isMenuOpen = false" class="nav-highlight">Mis Reservas</a>
    </li>

    <!-- Enlace Administrador -->
    <li *ngIf="user?.role === 'ADMIN'">
      <a routerLink="/admin/barbers" routerLinkActive="active" (click)="isMenuOpen = false" class="nav-highlight">Barberos</a>
    </li>
    <li *ngIf="user?.role === 'ADMIN'">
      <a routerLink="/admin/services" routerLinkActive="active" (click)="isMenuOpen = false" class="nav-highlight">Servicios</a>
    </li>
    <li *ngIf="user?.role === 'ADMIN'">
      <a routerLink="/admin/reports" routerLinkActive="active" (click)="isMenuOpen = false" class="nav-highlight">Reportes</a>
    </li>

    <!--Enlace Barbero-->
    <li *ngIf="user?.role === 'BARBER'">
      <a routerLink="/barber" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" (click)="isMenuOpen = false" class="nav-highlight">Gestión de Agenda</a>
    </li>
    <li *ngIf="user?.role === 'BARBER'">
      <a routerLink="/barber/reports" routerLinkActive="active" (click)="isMenuOpen = false" class="nav-highlight">Reportes</a>
    </li>
    
    <!-- Acciones Móviles (Dentro del menú) -->
    <li class="navbar-actions-mobile">
      
      <!-- Nota: Ya no ponemos el botón de Login aquí porque está arriba -->

      <!-- Caso Cliente: Botón Cerrar Sesión -->
      <div *ngIf="user" class="mobile-user-info">
        <button class="btn-logout-mobile" (click)="handleLogout()">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
          Cerrar Sesión
        </button>
      </div>

      <div class="theme-toggle-wrapper">
        <app-theme-toggle></app-theme-toggle>
      </div>
    </li>
  </ul>

  <!-- ACCIONES DESKTOP  -->
  <div class="navbar-actions-desktop">
    <app-theme-toggle></app-theme-toggle>
    <button *ngIf="!user" class="btn-login" (click)="handleLogin()">Iniciar Sesión</button>
    <div *ngIf="user?.role === 'CLIENT' || user?.role === 'BARBER'" class="user-menu-desktop">
      <span class="greeting">Hola, {{ user?.firstName }}</span>
      <button class="btn-logout-icon" (click)="handleLogout()" title="Cerrar Sesión">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 17 21 12 16 7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
      </button>
    </div>
    <div *ngIf="user?.role === 'ADMIN'" class="user-menu-desktop">
      <span class="greeting-admin">Bienvenido,<br> <strong>Admin {{ user?.firstName }}</strong></span>
      <button class="btn-logout-icon" (click)="handleLogout()" title="Cerrar Sesión">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 17 21 12 16 7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
      </button>
    </div>
  </div>
</nav>